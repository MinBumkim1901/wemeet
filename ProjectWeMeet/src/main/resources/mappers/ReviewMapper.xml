<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bsh.projectwemeet.mappers.ReviewMapper">


<insert id="insertReview"
        useGeneratedKeys="true"
        keyProperty="index"
        keyColumn="index"
        parameterType="com.bsh.projectwemeet.entities.ReviewEntity">
    INSERT INTO `wemeet_project`.`reviews`(`content`, `created_at`, `reviewStar`, `article_index`, `review_index`, `client_ip`, `client_ua` , `email`)
    VALUES (
            #{content},
            IFNULL(#{createdAt}, DEFAULT(`created_at`)),
            #{reviewStar},
            #{articleIndex},
            #{reviewIndex},
            #{clientIp},
            #{clientUa},
            #{email})
</insert>



    <select id="selectReviewByIndex"
    resultType="com.bsh.projectwemeet.entities.ReviewEntity">
        SELECT `index`,
               `content`,
               `created_at`,
               `reviewStar`,
               `article_index`,
               `review_index`,
               `client_ip`,
               `client_ua`,
               `email`
        FROM `wemeet_project`.`reviews`
        WHERE `article_index` = #{articleIndex}
        ORDER BY `index` ASC

    </select>


    <delete id="deleteByReview">
        DELETE
        FROM `wemeet_project`.`reviews`
        WHERE `index` = #{index}
        LIMIT 1
    </delete>

</mapper>